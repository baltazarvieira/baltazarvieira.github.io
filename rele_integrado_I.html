<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle do Relé</title>

<!-- Biblioteca MQTT para navegador -->
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f2f2f2;
    padding-top: 40px;
}
button {
    width: 160px;
    height: 55px;
    font-size: 20px;
    margin: 10px;
    cursor: pointer;
}
.status {
    font-size: 22px;
    margin-top: 25px;
    font-weight: bold;
}
</style>
</head>

<body>

<h2>Controle Remoto do Relé</h2>

<button onclick="sendMessage('ON')">LIGAR</button>
<button onclick="sendMessage('OFF')">DESLIGAR</button>

<div class="status" id="statusMsg">Conectando ao MQTT...</div>

<script>
// ===== CONFIGURAÇÕES MQTT =====
const options = {
    username: "baltazarvieira",
    password: "ZAQmko1968",
    clean: true,
    connectTimeout: 4000,
    reconnectPeriod: 2000
};

// ===== CONEXÃO WSS (NAVEGADOR) =====
const client = mqtt.connect(
    "wss://5123f02098764d0885f1db6e2d8fcab5.s1.eu.hivemq.cloud:8884/mqtt",
    options
);

// ===== TÓPICO =====
const topico = "rele_integrado1";

// ===== EVENTOS =====
client.on("connect", () => {
    document.getElementById("statusMsg").innerText =
        "Conectado ao HiveMQ";
});

client.on("reconnect", () => {
    document.getElementById("statusMsg").innerText =
        "Reconectando...";
});

client.on("error", (err) => {
    document.getElementById("statusMsg").innerText =
        "Erro MQTT";
    console.error(err);
});

// ===== FUNÇÃO BOTÃO =====
function sendMessage(msg) {
    client.publish(topico, msg);
}
</script>

</body>
</html>
